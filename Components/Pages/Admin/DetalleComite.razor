@page "/comite/{Id:int}"
@using SISTEMALEGAL.Models.DTOs
@using System.Linq
@using SISTEMALEGAL.Services.Interfaces
@inject IComiteRepository ComiteRepo
@inject NavigationManager NavManager

<PageTitle>Detalle del Comité</PageTitle>

<h3 class="mb-4">Detalle del Comité</h3>

@if (comite == null)
{
    <p>Cargando datos...</p>
}
else
{
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h5 class="card-title">@comite.ComiteSalud</h5>
            <p><strong>Corregimiento:</strong> @comite.Corregimiento</p>
            <p><strong>Distrito:</strong> @comite.Distrito</p>
            <p><strong>Provincia:</strong> @comite.Provincia</p>
            <p><strong>Región de Salud:</strong> @comite.RegionSalud</p>
            <p><strong>Tipo de Trámite:</strong> @comite.TipoTramite</p>
            <p><strong>Fecha de Elección:</strong> @(comite.FechaEleccion?.ToShortDateString())</p>
            <p><strong>Fecha de Creación:</strong> @(comite.FechaCreacion?.ToShortDateString())</p>
            <p><strong>Comunidad:</strong> @comite.Comunidad</p>

            @if (comite.Miembros != null && comite.Miembros.Any())
            {
                <h6>Miembros:</h6>
                <ul>
                    @foreach (var miembro in comite.Miembros)
                    {
                        <li>@miembro.Nombre - @miembro.Cedula (@miembro.Cargo)</li>
                    }
                </ul>
            }

            @if (comite.JuntaInterventoras != null && comite.JuntaInterventoras.Any())
            {
                <h6>Junta Interventora:</h6>
                <ul>
                    @foreach (var interventor in comite.JuntaInterventoras)
                    {
                        <li>@interventor.Nombre - @interventor.Cedula</li>
                    }
                </ul>
            }

            <div class="mt-3">
                <button class="btn btn-primary me-2" @onclick="Volver">Volver</button>
                <button class="btn btn-warning" @onclick="Editar">Editar</button>
            </div>
        </div>
    </div>
}

@code {
    [Parameter]
    public int Id { get; set; }

    private ComiteDto? comite;

    protected override async Task OnInitializedAsync()
    {
        comite = await ComiteRepo.GetByIdAsync(Id);
    }

    private void Volver()
    {
        NavManager.NavigateTo("/comites");
    }

    private void Editar()
    {
        NavManager.NavigateTo($"/editar-comite/{Id}");
    }
}