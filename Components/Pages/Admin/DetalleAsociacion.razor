@page "/asociacion/{id:int}"
@using SISTEMALEGAL.Models.DTOs
@using SISTEMALEGAL.Services.Interfaces
@inject IAsociacionRepository AsociacionRepository
@inject NavigationManager NavManager

<PageTitle>Detalle de Asociación</PageTitle>

<div class="container py-5">
    <div class="mx-auto col-lg-8">
        @if (asociacion == null)
        {
            <div class="text-center text-muted">
                <div class="spinner-border text-primary" role="status"></div>
                <p class="mt-3">Cargando datos...</p>
            </div>
        }
        else
        {
            <div class="card shadow-lg rounded-4">
                <div class="card-body p-4">
                    <h3 class="card-title text-center text-primary mb-4">@asociacion.Asociacion</h3>

                    <div class="row mb-3">
                        <div class="col-md-4"><strong>Tomo:</strong> @asociacion.Tomo</div>
                        <div class="col-md-4"><strong>Folio:</strong> @asociacion.Folio</div>
                        <div class="col-md-4"><strong>Asiento:</strong> @asociacion.Asiento</div>
                    </div>

                    @* <p><strong>Actividad de Salud:</strong> @asociacion.ActividadSalud</p> *@
                    @* <p><strong>Fecha de Creación:</strong> @asociacion.FechaCreacion.ToShortDateString()</p> *@

                    @if (asociacion.RepresentanteLegal is not null)
                    {
                        <div class="border-top mt-4 pt-3">
                            <h5 class="text-success">Representante Legal</h5>
                            <ul class="list-unstyled ms-3">
                                <li><strong>Nombre:</strong> @asociacion.RepresentanteLegal.Nombre</li>
                                <li><strong>Cédula:</strong> @asociacion.RepresentanteLegal.Cedula</li>
                                <li><strong>Cargo:</strong> @asociacion.RepresentanteLegal.Cargo</li>
                            </ul>
                        </div>
                    }

                    @if (asociacion.ApoderadoLegal is not null)
                    {
                        <div class="border-top mt-4 pt-3">
                            <h5 class="text-info">Apoderado Legal</h5>
                            <ul class="list-unstyled ms-3">
                                <li><strong>Nombre:</strong> @asociacion.ApoderadoLegal.Nombre</li>
                                <li><strong>Cédula:</strong> @asociacion.ApoderadoLegal.Cedula</li>
                                <li><strong>Email:</strong> @asociacion.ApoderadoLegal.Email</li>
                                <li>
                                    <strong>Firma:</strong>
                                    @(asociacion.ApoderadoLegal.EsFirmaAbogados
                                        ? $"Sí - {asociacion.ApoderadoLegal.FirmaAbogadosNombre}"
                                        : "No es firma de abogados")
                                </li>
                            </ul>
                        </div>
                    }

                    <div class="text-end mt-4">
                        <button class="btn btn-primary me-2" @onclick="Volver">Volver</button>
                        <button class="btn btn-warning" @onclick="Editar">Editar</button>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public int Id { get; set; }
    private RegistroAsociacionDto? asociacion;

    protected override async Task OnInitializedAsync()
    {
        asociacion = await AsociacionRepository.GetByIdAsync(Id);
        if (asociacion is null)
            NavManager.NavigateTo("/asociaciones");
    }

    private void Volver() => NavManager.NavigateTo("/asociaciones");
    private void Editar() => NavManager.NavigateTo($"/editar-asociacion/{Id}");
}
