@page "/registrar-asociacion"
@inject NavigationManager NavigationManager
@using System.ComponentModel.DataAnnotations

<PageTitle>Registrar Asociación</PageTitle>

<div class="container py-5">
    <div class="mx-auto col-lg-8">
        <h2 class="mb-4 text-center text-info">Registrar Asociación</h2>

        <EditForm Model="@asociacion" OnValidSubmit="Guardar">
            <DataAnnotationsValidator />
            <ValidationSummary class="text-danger" />

            <div class="row g-3 mb-3">
                <div class="col-md-12">
                    <label class="form-label">Nombre de la Asociación</label>
                    <InputText @bind-Value="asociacion.Asociacion" class="form-control" />
                </div>
                <div class="col-md-6">
                    <label class="form-label">Folio</label>
                    <InputText @bind-Value="asociacion.Folio" class="form-control" />
                </div>
                <div class="col-md-6">
                    <label class="form-label">Actividad de Salud</label>
                    <InputText @bind-Value="asociacion.ActividadSalud" class="form-control" />
                </div>
            </div>

            <hr />
            <h5 class="text-primary">Representante Legal</h5>
            <div class="row g-3 mb-3">
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Representante.Nombre" placeholder="Nombre" class="form-control" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Representante.Cedula" placeholder="Cédula" class="form-control" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Representante.Cargo" placeholder="Cargo" class="form-control" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Representante.Telefono" placeholder="Teléfono" class="form-control" />
                </div>
                <div class="col-12">
                    <InputText @bind-Value="asociacion.Representante.Direccion" placeholder="Dirección" class="form-control" />
                </div>
            </div>

            <hr />
            <h5 class="text-warning">Apoderado Legal</h5>
            <div class="row g-3 mb-3">
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Apoderado.Nombre" placeholder="Nombre" class="form-control" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Apoderado.Cedula" placeholder="Cédula" class="form-control" />
                </div>
                <div class="col-md-6">
                    <label class="form-label">¿Es firma de abogados?</label>
                    <InputCheckbox @bind-Value="asociacion.Apoderado.EsFirmaAbogados" class="form-check-input ms-2" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Apoderado.FirmaAbogadosNombre" placeholder="Nombre de la firma" class="form-control" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Apoderado.Email" placeholder="Correo electrónico" class="form-control" />
                </div>
                <div class="col-md-6">
                    <InputText @bind-Value="asociacion.Apoderado.Telefono" placeholder="Teléfono" class="form-control" />
                </div>
                <div class="col-12">
                    <InputText @bind-Value="asociacion.Apoderado.Direccion" placeholder="Dirección" class="form-control" />
                </div>
            </div>

            <div class="text-end mt-4">
                <button type="submit" class="btn btn-info text-white">Guardar Asociación</button>
                <button type="button" class="btn btn-secondary ms-2" @onclick="Cancelar">Cancelar</button>
            </div>
        </EditForm>
    </div>
</div>


@code {
    private AsociacionDto asociacion = new();

    private void Cancelar()
    {
        NavigationManager.NavigateTo("/");
    }

    private async Task Guardar()
    {
        // Aquí conectas con tu servicio o API
        // Ejemplo:
        // await _asociacionService.Guardar(asociacion);

        NavigationManager.NavigateTo("/asociaciones");
    }

    public class AsociacionDto
    {
        [Required(ErrorMessage = "El nombre de la asociación es obligatorio.")]
        public string Asociacion { get; set; }

        public string Folio { get; set; }
        public string ActividadSalud { get; set; }

        public RepresentanteLegalDto Representante { get; set; } = new();
        public ApoderadoLegalDto Apoderado { get; set; } = new();
    }

    public class RepresentanteLegalDto
    {
        public string Nombre { get; set; }
        public string Cedula { get; set; }
        public string Cargo { get; set; }
        public string Telefono { get; set; }
        public string Direccion { get; set; }
    }

    public class ApoderadoLegalDto
    {
        public string Nombre { get; set; }
        public string Cedula { get; set; }
        public bool EsFirmaAbogados { get; set; }
        public string FirmaAbogadosNombre { get; set; }
        public string Email { get; set; }
        public string Telefono { get; set; }
        public string Direccion { get; set; }
    }
}